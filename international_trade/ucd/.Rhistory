2/(2+74) # Not defeated, but revolution
1/(1+7)  # Defeated and revolution
N<-10000
set.seed(42)
theta0<-rbeta(N,3,75)  # theta0 | r0,n0
theta1<-rbeta(N,2,8)   # theta1 | r0,n1
q=theta1-theta0
q_mean<-c();q_lwr<-c();q_upr<-c();q_prop<-c()
for(i in 1:N){
q_mean[i]=mean(q[1:i])
q_lwr[i]=quantile(q[1:i],probs=.025)
q_upr[i]=quantile(q[1:i],probs=.975)
q_prop[i]=mean(q[1:i]>0)
}
par(mar=c(5,5,3,2),las=1,bty="n",pty="m",
cex.axis=1.5,cex.lab=1.5,cex.main=1.7)
plot(q,log="x",type="l",axes=FALSE,ylim=c(-.1,.8),
main="Sampled values",xlab="Sample size",
ylab=expression(q==theta[1]-theta[0]))
axis(1,tick=FALSE);axis(2,tick=FALSE)
plot(q_mean,log="x",type="l",axes=FALSE,ylim=c(-.1,.8),
main="Mean and 2.5% and 97.5% quantiles",xlab="Sample size",
ylab=expression(q==theta[1]-theta[0]))
lines(q_upr,lty=2)
lines(q_lwr,lty=2)
axis(1,tick=FALSE);axis(2,tick=FALSE)
plot(q_prop,log="x",type="l",axes=FALSE,main="PR(q> 0|y)",xlab="Sample size",
ylab="")
axis(1,tick=FALSE);axis(2,tick=FALSE)
hist(q,freq=FALSE,axes=FALSE,breaks=250,col="grey50",
main="Histogram, all samples",xlab="",ylab="Density")
axis(1,tick=FALSE);axis(2,tick=FALSE)
?rbeta
setwd("~/Dropbox/github/teaching/international_trade/ucd")
require(countrycode)
data(countrycode_data)
iso2c<-countrycode_data$iso2c
require(WDI)
t_m<-WDIsearch("tariff",field="name",short=FALSE) # 11
t2_m<-WDIsearch("trade",field="name",short=FALSE) # 89
wdi<-WDI(country=iso2c,c(t_m[11,1],t2_m[89,1]),start=2005,end=2015)
require(plyr)
d<-ddply(wdi,.(country),summarise,
tariff=mean(TM.TAX.MANF.SM.AR.ZS,na.rm=TRUE),
revenue=mean(GC.TAX.INTT.RV.ZS,na.rm=TRUE))
d<-na.omit(d)
d$continent<-countrycode(d$country,"country.name","continent")
d$p<-as.numeric(factor(d$continent))-1
par(mar=c(5,5,2,0),bty="n",las=1,cex.axis=2,cex.lab=2)
plot(d$tariff,d$revenue,pch=d$p,cex=2,axes=FALSE,
xlab="Tariff rate",ylab="Tariff revenue")
abline(a=0,b=1,lty=2,lwd=2)
axis(1,tick=FALSE,line=-1.5);axis(2,tick=FALSE,line=-1.5)
text(25,60,"Average for 2005-2015",cex=2)
names(wdi)
boxplot(wdi[,5]~wdi$year)
